<a name="readme-top"></a>
<div align="center">
  
  [![Contributors][contributors-shield]][contributors-url]
  [![Forks][forks-shield]][forks-url]
  [![Stargazers][stars-shield]][stars-url]
  [![Issues][issues-shield]][issues-url]
  [![MIT License][license-shield]][license-url]
  [![LinkedIn][linkedin-shield]][linkedin-url]

</div>
<br />
<div align="center">
  <a href="https://github.com/voaneves/xbox-sales">
    <img src="img/logo.png" alt="Logo" width="80" height="80">
  </a>

  <h3 align="center">xbox-sales</h3>

  <p align="center">
    A robust VBA automated dashboard generator inspired by Xbox Series X UI.
    <br />
    <a href="https://github.com/voaneves/xbox-sales"><strong>Explore the documentation »</strong></a>
    <br />
    <br />
    <a href="https://github.com/voaneves/xbox-sales/issues">Report a Bug</a>
    ·
    <a href="https://github.com/voaneves/xbox-sales/issues">Request a Feature</a>
  </p>
</div>

<details>
  <summary>Table of Contents</summary>
  <ol>
    <li>
      <a href="#about-the-project">About the Project</a>
      <ul>
        <li><a href="#technologies-used">Technologies Used</a></li>
      </ul>
    </li>
    <li><a href="#project-structure">Project Structure</a></li>
    <li><a href="#methodology">Methodology</a></li>
    <li><a href="#challenges-and-solutions">Challenges and Solutions</a></li>
    <li><a href="#results">Results</a></li>
    <li><a href="#getting-started">Getting started</a></li>
    <li><a href="#to-do">To Do</a></li>
    <li><a href="#reporting-bugs">Reporting Bugs</a></li>
    <li><a href="#license">License</a></li>
  </ol>
</details>

## About the project

<p align="center">
  <a href="https://voaneves.com/xbox-sales">
    <img alt="Dashboard Screenshot" src="img/dashboard_screenshot.jpg" />
  </a>
</p>

This repository contains an advanced VBA script designed to automate the creation of a Financial/Sales Dashboard inside Microsoft Excel.

The challenge is to transform raw CSV data into a "One Page" executive report with a single click, ensuring data integrity and a high-end visual experience based on the **Xbox Series X** design language (Dark Mode & Neon Green).

Key points to pay attention to:
- **Fail-Safe Engine:** A hidden calculation sheet that prevents `#REF!` errors.
- **Ghostbuster System:** Automatic cleanup of previous dashboard instances.
- **Dynamic Slicers:** Sidebar filters that control all visuals simultaneously.
- **One Page View:** Auto-zoom to 85% to fit the screen without scrolling.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

### Technologies Used

The project uses the following technologies:

- **Microsoft Excel:** The interface and calculation engine.
- **VBA (Visual Basic for Applications):** For ETL automation, chart generation, and UI construction.
- **Pivot Tables (Cache):** For high-performance data aggregation.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Project Structure

- `src/`
  - `CriarDashboardXbox_V9.bas` (The main source code)
- `data/`
  - `Bases.csv` (Sample dataset for testing)
- `img/`
  - `logo.png`
  - `dashboard_screenshot.jpg`
- `LICENSE`
- `README.md`

## Methodology

### Data Preparation (ETL)

**Sanitization:** The script automatically detects the data sheet (even with naming bugs like `B̳ases`), converts text-stored dates into real Date objects, and forces currency columns to numeric types to avoid aggregation errors.

### The "Hidden Engine" Concept

1. **Engine_Oculta:** Instead of linking charts directly to raw data, the script creates a hidden sheet (`xlSheetVeryHidden`) containing specific Pivot Tables.
2. **Static Mapping:** Key Performance Indicators (KPIs) are mapped to fixed cells using `GETPIVOTDATA` formulas generated by VBA. This ensures that the visual "Cards" never break, even if the data structure changes.

### UI/UX Design

3. **Visual Identity:** Application of RGB(20, 20, 20) for the background (True Dark Mode) and RGB(16, 124, 16) for accents (Xbox Green).
4. **Grid System:** Charts are generated with precise `Top`, `Left`, `Width`, and `Height` coordinates to form a perfect grid.

### Interactivity

5. **Slicers Loop:** A loop iterates through all generated Pivot Tables to connect them to the Slicers (Plan, Renewal, Type), creating a unified filtering experience.

## Challenges and Solutions

### Challenge 1: The "Name Already Taken" Error

- **Problem:** Running the macro multiple times caused the script to crash because sheets named "Dashboard_Xbox" already existed.
- **Solution:** Implemented the **"Ghostbuster"** routine. A loop checks for existing sheets (visible or hidden), forces them to be visible, and deletes them before generating new ones.

### Challenge 2: Date Clutter on Charts

- **Problem:** The raw dataset contained daily records, making the Area Chart unreadable (hundreds of points).
- **Solution:** Used the `.Group` method on the PivotField to automatically group dates by **Months and Years**, creating a smooth trendline.

### Challenge 3: Error 1004 on Filtering

- **Problem:** Trying to filter "Top 5 Clients" failed because the value field name changed depending on the Excel language (e.g., "Sum of" vs "Soma de").
- **Solution:** Implemented a dynamic reference `ptTop.DataFields(1).Name` to target the value field regardless of its display name.

### Challenge 4: Broken Cards (#REF!)

- **Problem:** When Slicers filtered data to zero, standard cell references returned errors.
- **Solution:** Replaced direct links with `IFERROR(GETPIVOTDATA(...), 0)` formulas injected by VBA.

## Results

1. **Efficiency:** Reduction of report generation time from ~20 minutes (manual) to **3 seconds**.
2. **Reliability:** The "Fail-Safe" engine ensures the dashboard can be generated even if data quality is less than perfect.
3. **Usability:** The layout was optimized for "At a Glance" reading, with the most important KPIs at the top and filters on the right.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Getting started

1. Open your Excel file containing the data (ensure the sheet is named `Bases` or similar).

2. Press `Alt + F11` to open the VBA Editor.

3. Go to `Insert > Module` and paste the code from `CriarDashboardXbox_V9.bas`.

4. Press `F5` to run the macro.

5. The dashboard will be generated automatically in a new sheet.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## To do

- [ ] Add a "Export to PDF" button directly on the dashboard.
- [ ] Create a userform for custom date range selection before generation.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Reporting bugs

Found a bug or issue in the project? Follow the steps below:

1. Check if the bug has already been reported in our "Issues" section on GitHub.

2. If you don't find an existing report about the bug, click on "New Issue" to open a new bug report.

3. Provide a clear and descriptive title for the bug, along with a detailed description of the steps needed to reproduce it.

4. If possible, include screenshots (like the error 1004 dialog), or the specific dataset line causing the crash.

5. Click on "Submit Issue" to create the bug report.

Thank you for reporting bugs! If you would like to contribute with code, you can open a PR, and your participation is more than welcome.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## License

This project is licensed under the [MIT License](/LICENSE).

<p align="right">(<a href="#readme-top">back to top</a>)</p>

[contributors-shield]: https://img.shields.io/github/contributors/voaneves/xbox-sales.svg?style=for-the-badge
[contributors-url]: https://github.com/voaneves/xbox-sales/graphs/contributors
[forks-shield]: https://img.shields.io/github/forks/voaneves/xbox-sales.svg?style=for-the-badge
[forks-url]: https://github.com/voaneves/xbox-sales/network/members
[stars-shield]: https://img.shields.io/github/stars/voaneves/xbox-sales.svg?style=for-the-badge
[stars-url]: https://github.com/voaneves/xbox-sales/stargazers
[issues-shield]: https://img.shields.io/github/issues/voaneves/xbox-sales.svg?style=for-the-badge
[issues-url]: https://github.com/voaneves/xbox-sales/issues
[license-shield]: https://img.shields.io/github/license/voaneves/xbox-sales.svg?style=for-the-badge
[license-url]: https://github.com/voaneves/xbox-sales/blob/main/LICENSE
[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://linkedin.com/in/voaneves
